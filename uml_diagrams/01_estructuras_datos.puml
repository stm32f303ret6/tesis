@startuml Estructuras_de_Datos_Principales
!theme plain
skinparam classAttributeIconSize 0
skinparam roundcorner 10
skinparam shadowing false

title Estructuras de Datos para Residual PPO

package "Observación y Acción" #EFEFEF {
    class ObservationVector <<dataclass>> {
        + body_state: ndarray[13]
        + joint_state: ndarray[24]
        + foot_state: ndarray[24]
        + contacts: ndarray[4]
        --
        + dimension(): int
    }

    class ActionVector <<dataclass>> {
        + residuals: Dict[str, ndarray[3]]
        + scale: float
        --
        + dimension(): int
    }
}

package "Parámetros y Control" #E7F0FF {
    class GaitParameters <<dataclass>> {
        + body_height: float
        + step_length: float
        + step_height: float
        + cycle_time: float
    }

    class TrainingConfig <<dataclass>> {
        + total_timesteps: int
        + n_envs: int
        + batch_size: int
        + learning_rate: float
        + residual_scale: float
    }
}

package "Almacenamiento y Métricas" #FCEFD6 {
    class RolloutBuffer <<dataclass>> {
        + observations: ndarray[n_steps, n_envs, 65]
        + actions: ndarray[n_steps, n_envs, 12]
        + rewards: ndarray[n_steps, n_envs, 1]
        + advantages: ndarray[n_steps, n_envs, 1]
        + returns: ndarray[n_steps, n_envs, 1]
    }

    class TrainingMetrics <<dataclass>> {
        + episode_reward: float
        + episode_length: int
        + policy_loss: float
        + value_loss: float
    }
}

RolloutBuffer o-- ObservationVector : almacena
RolloutBuffer o-- ActionVector : almacena
TrainingConfig ..> RolloutBuffer : dimensiona
TrainingConfig ..> GaitParameters : fija límites
TrainingMetrics ..> TrainingConfig : resume
ActionVector ..> GaitParameters : aplica
ObservationVector ..> GaitParameters : valida altura

@enduml
